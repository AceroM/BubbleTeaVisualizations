{"ast":null,"code":"import _toConsumableArray from\"/Users/miguel/DataVisualization/BubbleTeaVisualizations/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/miguel/DataVisualization/BubbleTeaVisualizations/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';var d3=require('d3');var forceStrength=0.03;var width=940;var height=600;var center={x:width/2,y:height/2};var colorFn=d3.scaleLinear().domain([7,15]).range(['#dcdbe8','#F0DFC5','#fbc4a7']);function startSimulation(bubbles,updateState){function charge(d){return-Math.pow(d.radius,2.0)*forceStrength;}var simulation=d3.forceSimulation().velocityDecay(0.2).force('x',d3.forceX().strength(forceStrength).x(center.x)).force('y',d3.forceY().strength(forceStrength).y(center.y)).force('charge',d3.forceManyBody().strength(charge)).on('tick',function(){return updateState(bubbles);}).stop();simulation.nodes(bubbles);simulation.alpha(1).restart();}function formatBubbleData(rawData){var maxValue=d3.max(rawData,function(d){return+d.value;});var radiusScale=d3.scalePow().exponent(0.5).range([2,85]).domain([0,maxValue]);var myBubbles=rawData.map(function(d){return{name:d.name,value:d.value,radius:radiusScale(d.value),x:Math.random()*width,y:Math.random()*height};});// sort them to prevent occlusion of smaller nodes.\nmyBubbles.sort(function(a,b){return b.value-a.value;});return myBubbles;}export default function Bubbles(_ref){var data=_ref.data;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),bubbles=_useState2[0],setBubbles=_useState2[1];useEffect(function(){startSimulation(formatBubbleData(data),function(bubbles){setBubbles(function(){return _toConsumableArray(bubbles);});});},[data]);return React.createElement(\"svg\",{className:\"bubbles\",width:width,height:height},bubbles.map(function(bubble){return React.createElement(\"circle\",{key:bubble.name,r:bubble.radius,fill:colorFn(bubble.value),stroke:d3.rgb(colorFn(bubble.value)).darker(),strokeWidth:2,cx:bubble.x,cy:bubble.y},React.createElement(\"title\",null,bubble.name));}));}","map":{"version":3,"sources":["/Users/miguel/DataVisualization/BubbleTeaVisualizations/frontend/src/components/BubbleTea/Bubbles.js"],"names":["React","useState","useEffect","d3","require","forceStrength","width","height","center","x","y","colorFn","scaleLinear","domain","range","startSimulation","bubbles","updateState","charge","d","Math","pow","radius","simulation","forceSimulation","velocityDecay","force","forceX","strength","forceY","forceManyBody","on","stop","nodes","alpha","restart","formatBubbleData","rawData","maxValue","max","value","radiusScale","scalePow","exponent","myBubbles","map","name","random","sort","a","b","Bubbles","data","setBubbles","bubble","rgb","darker"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n\nconst d3 = require('d3')\n\nconst forceStrength = 0.03\n\nconst width = 940\nconst height = 600\nconst center = { x: width / 2, y: height / 2 }\n\nconst colorFn = d3\n  .scaleLinear()\n  .domain([7, 15])\n  .range(['#dcdbe8', '#F0DFC5', '#fbc4a7'])\n\nfunction startSimulation(bubbles, updateState) {\n  function charge(d) {\n    return -Math.pow(d.radius, 2.0) * forceStrength\n  }\n\n  const simulation = d3\n    .forceSimulation()\n    .velocityDecay(0.2)\n    .force(\n      'x',\n      d3\n        .forceX()\n        .strength(forceStrength)\n        .x(center.x)\n    )\n    .force(\n      'y',\n      d3\n        .forceY()\n        .strength(forceStrength)\n        .y(center.y)\n    )\n    .force('charge', d3.forceManyBody().strength(charge))\n    .on('tick', () => updateState(bubbles))\n    .stop()\n\n  simulation.nodes(bubbles)\n  simulation.alpha(1).restart()\n}\n\nfunction formatBubbleData(rawData) {\n  const maxValue = d3.max(rawData, function(d) {\n    return +d.value\n  })\n\n  const radiusScale = d3\n    .scalePow()\n    .exponent(0.5)\n    .range([2, 85])\n    .domain([0, maxValue])\n\n  const myBubbles = rawData.map(d => ({\n    name: d.name,\n    value: d.value,\n    radius: radiusScale(d.value),\n    x: Math.random() * width,\n    y: Math.random() * height,\n  }))\n\n  // sort them to prevent occlusion of smaller nodes.\n  myBubbles.sort(function(a, b) {\n    return b.value - a.value\n  })\n\n  return myBubbles\n}\n\nexport default function Bubbles({ data }) {\n  const [bubbles, setBubbles] = useState([])\n\n  useEffect(() => {\n    startSimulation(formatBubbleData(data), bubbles => {\n      setBubbles(() => [...bubbles])\n    })\n  }, [data])\n\n  return (\n    <svg className=\"bubbles\" width={width} height={height}>\n      {bubbles.map(bubble => {\n        return (\n          <circle\n            key={bubble.name}\n            r={bubble.radius}\n            fill={colorFn(bubble.value)}\n            stroke={d3.rgb(colorFn(bubble.value)).darker()}\n            strokeWidth={2}\n            cx={bubble.x}\n            cy={bubble.y}\n          >\n            <title>{bubble.name}</title>\n          </circle>\n        )\n      })}\n    </svg>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}