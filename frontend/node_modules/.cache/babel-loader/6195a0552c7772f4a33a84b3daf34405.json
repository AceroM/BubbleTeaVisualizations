{"ast":null,"code":"import _slicedToArray from \"/Users/miguel/DataVisualization/BubbleTeaVisualizations/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/miguel/DataVisualization/BubbleTeaVisualizations/frontend/src/components/BubbleTea/Bubbles.js\";\nimport React, { useState, useEffect } from 'react';\n\nconst d3 = require('d3');\n\nconst forceStrength = 0.03;\nconst width = 940;\nconst height = 600;\nconst center = {\n  x: width / 2,\n  y: height / 2\n};\nconst colorFn = d3.scaleLinear().domain([7, 15]).range(['#dcdbe8', '#69bf64', '#F0DFC5', '#fbc4a7']);\n\nfunction startSimulation(bubbles, updateState) {\n  function charge(d) {\n    return -Math.pow(d.radius, 2.0) * forceStrength;\n  }\n\n  var showTooltip = function (d) {\n    bubbles.transition().duration(200);\n    bubbles.style('opacity', 1).html('Country: ' + d.country).style('left', d3.mouse(this)[0] + 30 + 'px').style('top', d3.mouse(this)[1] + 30 + 'px');\n  };\n\n  var moveTooltip = function (d) {\n    bubbles.style('left', d3.mouse(this)[0] + 30 + 'px').style('top', d3.mouse(this)[1] + 30 + 'px');\n  };\n\n  var hideTooltip = function (d) {\n    bubbles.transition().duration(200).style('opacity', 0);\n  };\n\n  const simulation = d3.forceSimulation().velocityDecay(0.2).force('x', d3.forceX().strength(forceStrength).x(center.x)).force('y', d3.forceY().strength(forceStrength).y(center.y)).force('charge', d3.forceManyBody().strength(charge)).on('tick', () => updateState(bubbles)).on('mouseover', showTooltip).on('mousemove', moveTooltip).on('mouseleave', hideTooltip).stop();\n  simulation.nodes(bubbles);\n  simulation.alpha(1).restart();\n}\n\nfunction formatBubbleData(rawData) {\n  const maxValue = d3.max(rawData, function (d) {\n    return +d.value;\n  });\n  const radiusScale = d3.scalePow().exponent(0.5).range([2, 85]).domain([0, maxValue]);\n  const myBubbles = rawData.map(d => ({\n    name: d.name,\n    value: d.value,\n    radius: radiusScale(d.value),\n    x: Math.random() * width,\n    y: Math.random() * height\n  })); // sort them to prevent occlusion of smaller nodes.\n\n  myBubbles.sort(function (a, b) {\n    return b.value - a.value;\n  });\n  return myBubbles;\n}\n\nexport default function Bubbles({\n  data\n}) {\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        bubbles = _useState2[0],\n        setBubbles = _useState2[1];\n\n  useEffect(() => {\n    startSimulation(formatBubbleData(data), bubbles => {\n      setBubbles(() => [...bubbles]);\n    });\n  }, [data]);\n  return React.createElement(\"svg\", {\n    className: \"bubbles\",\n    width: width,\n    height: height,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, bubbles.map(bubble => {\n    return React.createElement(\"circle\", {\n      key: bubble.name,\n      r: bubble.radius,\n      fill: colorFn(bubble.value),\n      stroke: d3.rgb(colorFn(bubble.value)).darker(),\n      strokeWidth: 2,\n      cx: bubble.x,\n      cy: bubble.y,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"title\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, bubble.name));\n  }));\n}","map":{"version":3,"sources":["/Users/miguel/DataVisualization/BubbleTeaVisualizations/frontend/src/components/BubbleTea/Bubbles.js"],"names":["React","useState","useEffect","d3","require","forceStrength","width","height","center","x","y","colorFn","scaleLinear","domain","range","startSimulation","bubbles","updateState","charge","d","Math","pow","radius","showTooltip","transition","duration","style","html","country","mouse","moveTooltip","hideTooltip","simulation","forceSimulation","velocityDecay","force","forceX","strength","forceY","forceManyBody","on","stop","nodes","alpha","restart","formatBubbleData","rawData","maxValue","max","value","radiusScale","scalePow","exponent","myBubbles","map","name","random","sort","a","b","Bubbles","data","setBubbles","bubble","rgb","darker"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n\nconst d3 = require('d3')\n\nconst forceStrength = 0.03\n\nconst width = 940\nconst height = 600\nconst center = { x: width / 2, y: height / 2 }\n\nconst colorFn = d3\n  .scaleLinear()\n  .domain([7, 15])\n  .range(['#dcdbe8', '#69bf64', '#F0DFC5', '#fbc4a7'])\n\nfunction startSimulation(bubbles, updateState) {\n  function charge(d) {\n    return -Math.pow(d.radius, 2.0) * forceStrength\n  }\n  var showTooltip = function(d) {\n    bubbles.transition().duration(200)\n    bubbles\n      .style('opacity', 1)\n      .html('Country: ' + d.country)\n      .style('left', d3.mouse(this)[0] + 30 + 'px')\n      .style('top', d3.mouse(this)[1] + 30 + 'px')\n  }\n  var moveTooltip = function(d) {\n    bubbles\n      .style('left', d3.mouse(this)[0] + 30 + 'px')\n      .style('top', d3.mouse(this)[1] + 30 + 'px')\n  }\n  var hideTooltip = function(d) {\n    bubbles\n      .transition()\n      .duration(200)\n      .style('opacity', 0)\n  }\n\n  const simulation = d3\n    .forceSimulation()\n    .velocityDecay(0.2)\n    .force(\n      'x',\n      d3\n        .forceX()\n        .strength(forceStrength)\n        .x(center.x)\n    )\n    .force(\n      'y',\n      d3\n        .forceY()\n        .strength(forceStrength)\n        .y(center.y)\n    )\n    .force('charge', d3.forceManyBody().strength(charge))\n    .on('tick', () => updateState(bubbles))\n    .on('mouseover', showTooltip)\n    .on('mousemove', moveTooltip)\n    .on('mouseleave', hideTooltip)\n    .stop()\n\n  simulation.nodes(bubbles)\n  simulation.alpha(1).restart()\n}\n\nfunction formatBubbleData(rawData) {\n  const maxValue = d3.max(rawData, function(d) {\n    return +d.value\n  })\n\n  const radiusScale = d3\n    .scalePow()\n    .exponent(0.5)\n    .range([2, 85])\n    .domain([0, maxValue])\n\n  const myBubbles = rawData.map(d => ({\n    name: d.name,\n    value: d.value,\n    radius: radiusScale(d.value),\n    x: Math.random() * width,\n    y: Math.random() * height,\n  }))\n\n  // sort them to prevent occlusion of smaller nodes.\n  myBubbles.sort(function(a, b) {\n    return b.value - a.value\n  })\n\n  return myBubbles\n}\n\nexport default function Bubbles({ data }) {\n  const [bubbles, setBubbles] = useState([])\n\n  useEffect(() => {\n    startSimulation(formatBubbleData(data), bubbles => {\n      setBubbles(() => [...bubbles])\n    })\n  }, [data])\n\n  return (\n    <svg className=\"bubbles\" width={width} height={height}>\n      {bubbles.map(bubble => {\n        return (\n          <circle\n            key={bubble.name}\n            r={bubble.radius}\n            fill={colorFn(bubble.value)}\n            stroke={d3.rgb(colorFn(bubble.value)).darker()}\n            strokeWidth={2}\n            cx={bubble.x}\n            cy={bubble.y}\n          >\n            <title>{bubble.name}</title>\n          </circle>\n        )\n      })}\n    </svg>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}